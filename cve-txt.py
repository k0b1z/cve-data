import json
from datetime import datetime
from datetime import timedelta

from slack import WebClient
from slack.errors import SlackApiError

import requests

pubStartDate = "2022-08-01T00:00:00:000 UTC-03:00"

pubEndDate = "2022-08-31T00:00:00:000 UTC-03:00"

response = requests.get('https://services.nvd.nist.gov/rest/json/cves/1.0/?resultsPerPage=2000&pubStartDate=' + pubStartDate + '&pubEndDate=' + pubEndDate)
print('https://services.nvd.nist.gov/rest/json/cves/1.0/?resultsPerPage=2000&pubStartDate=' + pubStartDate + '&pubEndDate=' + pubEndDate)

cve = response.json()

arquivo = open("cve.txt", "a")

for item in cve['result']['CVE_Items']:
    if item['impact']:
        if int(item['impact']['baseMetricV3']['cvssV3']['baseScore']) > 6.9:
            arquivo.write(json.dumps(item))
            arquivo.write("\n\n")

